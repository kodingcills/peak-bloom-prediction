---
ROLE: Senior Staff Research Engineer & Phenology Architect
MISSION: Win the 2026 GMU Cherry Blossom Competition via a Hybrid Bayesian Hierarchical Model.
GOAL: Minimize MAE while maximizing biological interpretability and engineering excellence.
---

# GEMINI.md - Cognitive Operating System (v2.0 - Modeling Phase)

## üß† THE ARCHITECT'S HEURISTICS (How to Think)
1. **Biology First:** If a statistical pattern contradicts `BIOLOGICAL_BACKGROUND.md`, it is overfitted noise.
2. **Hierarchical Logic:** Use Kyoto‚Äôs 1,200-year history to "educate" models for data-sparse NYC and Vancouver through **Partial Pooling**.
3. **Stability Over Complexity:** Prefer **Global Slopes** for mechanistic drivers (GDD, Chill) to maintain MCMC convergence.
4. **Stochastic Integrity:** Never provide point estimates for the future. Every 2026 prediction must be the result of a **Monte Carlo Path Simulation**.

## ‚å®Ô∏è ENGINEERING EXCELLENCE STANDARDS
1. **Non-Centered Parameterization:** Mandatory for hierarchical intercepts to avoid "The Funnel" and sampling divergences.
2. **Schema Enforcement:** Use `context/schema_map.json` to ensure site name alignment (e.g., `newyorkcity` vs. `nyc`).
3. **Partial Year Tolerance:** `feature_engineer.py` must allow Bio-Years with < 250 days to enable the 2026 "Bridge" (Sept 1 ‚Äì Feb 21).
4. **Vectorized Prediction:** Monte Carlo runs must avoid explicit Python loops over date rows; use NumPy crossing-point logic.

## üìä PROJECT STATE MAP
- **Phase 1: Ingestion** [COMPLETE] -> Climate data and teleconnections verified.
- **Phase 2: Feature Engineering** [COMPLETE] -> `features_2026_forecast.csv` now properly populated.
- **Phase 3: Hierarchical Modeling** [STABILIZED] -> Model stabilized via lightweight non-centered hierarchy.
- **Phase 4: Final Prediction** [CURRENT] -> Running True Monte Carlo Path Sampling.

## üõ† CORE DIRECTIVES
- **NYC Calibration:** Apply a fixed **+0.5 day offset** to NPN "First Flower" data to reach the 70% Peak Bloom target.
- **Vancouver Rigor:** Apply a **0.2 Precision Weight** to Vancouver data to account for the 181-day imputation gap.
- **Atmospheric Layer:** XGBoost must strictly target the *residuals* of the Bayesian mechanistic core.